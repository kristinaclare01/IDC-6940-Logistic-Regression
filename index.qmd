---
title: "Predicting disease risk from daily habits: a binary logistic regression analysis"
subtitle: A statistical analysis- Fall 2025
authors: "Kristina Kusem, Shree Basnet, Renan Barbosa (Advisor: Dr. Cohen)"
date: '`r Sys.Date()`'
format:
  html:
    code-fold: true
course: Capstone Projects in Data Science
bibliography: references.bib # file contains bibtex for references
#always_allow_html: true # this allows to get PDF with HTML features
self-contained: true
execute: 
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
---

<!-- Formatting for background color of entire page -->
<style>
body {
  background-color: lightblue; /* Change to your desired color */
}
</style>

<!--Formatting for text color: \n 
<span style="color: midnightblue;">This text is blue.</span> And this text is <span style="color: blue;">blue.</span> -->


Slides: [slides.html](slides.html){target="_blank"} ( Go to `slides.qmd`
to edit)

<!--::: callout-important
**Remember:** Your goal is to make your audience understand and care
about your findings. By crafting a compelling story, you can effectively
communicate the value of your data science project.

Carefully read this template since it has instructions and tips to
writing!

Nice report!
::: -->


<!-- The introduction should:

-   Develop a storyline that captures attention and maintains interest.

-   Your audience is your peers

-   Clearly state the problem or question you're addressing.



-   Introduce why it is relevant needs.

-   Provide an overview of your approach.

Example of writing including citing references:

*This is an introduction to ..... regression, which is a non-parametric
estimator that estimates the conditional expectation of two variables
which is random. The goal of a kernel regression is to discover the
non-linear relationship between two random variables. To discover the
non-linear relationship, kernel estimator or kernel smoothing is the
main method to estimate the curve for non-parametric statistics. In
kernel estimator, weight function is known as kernel function
[@efr2008]. Cite this paper [@bro2014principal]. The GEE [@wang2014].
The PCA [@daffertshofer2004pca]*. Topology can be used in machine
learning [@adams2021topology]

For Symbolic Regression [@wang2019symbolic] *This is my work and I want
to add more work...*

Cite new paper [@su2012linear]  -->

## Rough draft/ outline of Introduction and Literature Review:

### Introduction:

-State what logistic regression is and why it is commonly used in research (it helps make predictions about categorical outcome variables, usually a binary outcome. It also helps to analyze several predictors simultaneously and how they all relate to the outcome variable at once). Discuss how we usually model LR and how we interpret results.<br>
-Discuss which types of scenarios logistic regression is usually used in. It is actually used in a variety of contexts and is very useful for solving everyday problems around the world:<br>
 -disease detection- identifying predictors of the presence of a disease helps people make preventive decisions regarding their health. It also helps practitioners more easily identify and diagnose specific health conditions. <br>
-predictions about the way people make decisions; specifically, healthcare decisions<br>
-traffic and accident prediction <br>
-fraud detection<br>

### Literature Review:

#### Articles about using logistic regression in medical contexts:

1. "Understanding logistic regression analysis" discusses the usefulness of a logistic regression model and describes how to set up and interpret such a model when analyzing data. A logistic regression model is especially useful when dealing with more than two predictors and an outcome variable that has two or more classes or categories. This article gives an example of a logistic regression analysis with a synthetic dataset about patients undergoing a drug treatment. The outcome variable is categorical and binary in nature, taking on values of survived (1), or did not survive (0). The result of the analysis gives an explanation of how to interpret output from the model. One must take the expnentials of the slopes in the model to find the chances (the probability) of an event occurring. It is noted that in order to correctly understand results of a logistic regression, one must carefully consider the differences between the odds ratio, the log odds, and the probabilities of events occurring. Another important point in the article states the importance of feature selection; a common way that predictors are selected for a logistic regression model is through a preliminary univariate analysis. During data preprocessing, all predictors are analyzed individually in relation to the outcome variable in a univariate analysis, and all significant predictors are used in the multivariate logistic regression analysis.  

2. "Determinants of coexistence of undernutrition and anemia among under- five children in Rwanda; evidence from 2019/20 demographic health survey: Application of bivariate binary logistic regression model"

-This article details a bivariate binary logistic regression model. There are two outcome variables: anemia and undernutrition in children under five years of age in Rwanda. The study analyzes the relationship between the two outcome variables, as well as the relationship between 26 predictors relating to the childrens’ preexisting health conditions, family information, details about the parents, and relevant geographic information. One result of the study was that the relationship between the two outcome variables, presence of malnutrition and presence of anemia, was found to be significant. It was also found that six predictors were found to be sinificant: mother’s age, drinking water, other children in household, child gender, birth order, and gender of head of household. The conclusion states that improving maternal education, supplementing with vitamin A and other nutrient dense foods, providing a healthy home environment environment, and decreasing maternal anemia may help improve rates of malnutrition and anemia in children.

3. "Predictors of hospital admission when presenting with acute on chronic breathlessness: Binary logistic regression" 

In this study, emergency room data from one hospital is analyzed to determine common predictors of patients that are admited to the hospital. Specifically, patients presenting to the emergency room with acute on chronic breahtlessness were surveyed to collect data that would help researchers understand common factors among those admitted to the hospital. Knowing common predictors ahead of time helps hospital staff more easily identify pateints who are more at risk for being admitted to the hospital, and also helps identify which patients would be more likely to be able to be discharged without being admitted. A binary logistic regression analysis of the data revealed that the odds of admission to the hospital were positively correlated with age, talking to a doctor about symptoms, and the presence of preexisting heart conditions; however, the odds of being admitted to the hospital were negatively associated with blood oxygen levels. 



4. "Risk factors for airplane headache: A multivariate logistic regression analysis in a population of career flight personnel"

Problem:<br>
-Airplane headache (AH) is a headache disorder described as a headache induced while taking off or landing in an airplane. It was not until 2004 that the disorder was recognized and classified as a medical issue. Because this disorder has just recently been recognized, there is little existing research on it.
-There is a lot of previous literature and research regarding other headache types and disorders, but AH is still lacking appropriate research.
-Specifically, this study aims to identify predictors and risk factors that occur before onset of airplane headache. Knowing the predictors would help both travelers and employees of airlines. 
-AH is a common disorder affecting about 65 million people worldwide every year, so helping prevent and treat it is crucial. Future research is therefore a must.

Solution:<br>
-Conduct a logistic regression analysis to determine significant predictors of airplane headache. Two binary logistic regression models were constructed; one model’s outcome was either airplane headache (1) or no headache (0), and the other model’s outcomes were airplane headache (1) or other headache (0). 
-Used R to conduct statistical analysis

Data:<br>
-Data was collected from a voluntary online survey sent out to about 20,000 pilots who fly frequently due to work. A total of 2237 complete questionnaires from a 3 month period in 2014 were received and used in the dataset for this study. 
-The data/ questions in the survey were determined by pain specialists
-Predictors included in the survey were: demographic information, health history, substance use, medication use, stress levels, and headache/ physical symptoms while flying.
-The outcome variable was divided into three categories: airplane headache, no headache, and other type of headache.
-Predictors were tested for multicollinearity before models were constructed
-Data was further reduced using stepwise backward elimination (starting with all predictors and then eliminating least significant predictors)

Results/ Conclusions: <br>
-Survey results revealed that a vast majority of participants said they had some form of headache while flying on an airplane (82%)
-The first model comparing airplane headache with no headache was found to have 10 significant predictors. The AUC for this model showed that it had strong predictive power.
-The second model comparing airplane headache with other headache was found to have only four significant predictors. The AUC also showed that this model had low predictive power. This is likely attributed to the fact that airplane headache and other types of headaches all have similar predictors, so it is not easy to distinguish between strong predictors for just AH as compared to all types of headaches.
-Conclusions: supplementing with folic acid before flight may help reduce risk of airplane headache. Other strong predictors of airplane headache are occupation, work stress, and preexisting headache medical conditions.
-Further research about airplane headache is necessary because of all the ongoing negative subsequent events caused by it. It causes people loss of productivity, avoidance behaviors, stress, and anxiety.

Limitations: <br>
-Only 12% of surveyed individuals submitted their survey. It could be the case that only the people who suffered from headaches responded to the survey, so the proportions of individuals with airplane headache in this study are not representative of the entire population. This is called positive selection bias.
-Participants in the survey may not be reporting accurate information because a lot of time passes between the event of their airplane travel and the time when they take the survey.



5. "Exploring the medical decision- making patterns and influencing factors among the general Chinese public: a binary logistic regression analysis"

Problem: <br>
-Researchers are seeking to understand top driving factors behind decisions made about healthcare and medical issues. The population of interest is the general Chinese public.
-Previous research in this field has identified two main types of medical decision making: unilateral and collaborative decision making
-Unilateral decision making means there is one main entity making the medical decision, such as a single patient, a patient’s family, or a doctor. Previous research shows that patient families have a very strong influence over a patient’s medical decisions.
-Collaborative decision making means there are two or more parties involved in the decision making process. Three subgroups are defined: doctor group, doctor- patient group, patient- family group, and patient-doctor-family group.
-There is a lack in research in this field. More needs to be known about factors that play a role in medical decision making processes. This study’s results will be generalizable to China as well as nations around the world. 

Solution:<br>
-Use binary logistic regression to classify points into two categories: unilateral decision making (value of 1), or collaborative decision making (value of 0)
-This model is ideal because it takes into account variable interactions. Also used often in the medical field
-The equation of the model is given. It is in the form of the log odds of the desired event happening.

Data:<br>
-2696 data points with attributes including age, education, occupation, family situation, religion, economic status and medical payment methods
-Data was collected via survey and included only residents of China from 31 provinces
-The data was gathered by the researchers that wrote this study
-A power analysis was conducted to determine how many data points would be needed in order to have reliable results after statistical analysis. A G-power test showed that only 2040 valid data points were needed

Results:<br>
-Survey results showed that 30% of responses were categorized as unilateral decision making, while 70% were categorized as collaborative decision making. The top category of unilateral decision making was doctor- led decisions, while the top category for collaborative decision making was patient- doctor- family decisions.
-Significant predictors were identified with p-values less than 0.05. Significant predictors of unilateral decision making were gender, education level, family status, and religious beliefs. Different occupations also significantly predicted unilateral decision making. 
-Odds ratios are given for some predictors, with researchers stating that certain categories of specific predictors are x.xx times more likely than the reference group to be a unilateral decision maker.
-The significance of the regression model’s intercept is interpreted, and it is significant. This means when all variables are at their reference levels, there is a low likelihood of the outcome variable taking on a value of a unilateral decision making process.
-The goodness of fit test used in this study is McFadden’s R-squared value. The value was0.065, and researchers state that this value shows a good fit of the model. It is explained that R squared values for studies in the social sciences are rarely ever close to a perfect fit. 

Conclusions:<br>
-The researchers discuss why there are contrasting results from this study versus studies in Western countries. They identify different cultural values in different geographic regions, which ultimately lead to different medical decision making processes. 
-Results are discussed more in depth, with researchers attempting to identify causes behind the correlations that were identified. 

Limitations:<br>
-The study’s data is solely from China, so results may not be generalizable to global populations.
-The binary logistic regression model may not be complex enough to account for the complexities of all the predictors involved in healthcare decision making. Researchers suggest using more complex models in future research. 



#### Articles about using logistic regression in traffic and engineering contexts:

1. "Binary logistic regression analysis of factors affecting urban road traffic safety"

Problem:<br>
The introduction features a literature review establishing relevance of the topic. Several studies about traffic accidents are discussed and cited. Traffic accidents are becoming more common as traffic increases due to population increases. Researchers aim to find which factors in traffic are more closely associated with the occurrence of traffic accidents. 

Solution:<br>
The researchers use a binary logistic regression model to study which factors are more correlated to the occurrence of traffic accidents. The advantages of a binary logistic regression are discussed. Logistic regression allows researchers to make predictions about probability of a dependent variable being sorted into a certain class. Logistic regression also allows for the researchers to determine which predictors more significantly impact the outcome variable. 
To set up the study, researchers defined the dependent variable, y, as a binary outcome of either no accident (value of 0) or presence of an accident (value of 1). The independent variables are defined as 25 factors that are grouped under four categories consisting of environmental factors, driver attributes, road attributes, and vehicle factors. Before analyzing the data, it was preprocessed to eliminate outliers, normalize all predictor values to similar scales, eliminate redundancy, Then, the predictors were run through a multicollinearity test to determine if any needed to be excluded from the model; none of the factors showed significant multicollinearity and all 25 were kept in the model. The calculation used for collinearity involved the correlation coefficient, R, tolerance (T), and variance inflation factor (V).

Results:<br>
A binary logistic regression model was fitted to the data, and it was found that the model fit well. To assess the goodness of fit, the determination coefficient, R^2, value was calculated. 
The strongest predictors of a traffic incident were found to be driver behavior, weather, road conditions, and lighting. 

Limitations:<br>
The paper states that research in this area can be improved by using real- time data about weather, road conditions, and driver status. Using data as it occurs in real time may help make better predictions about traffic safety risks.

Dataset:<br>
The original data was sourced from the International Transport Forum with 5350 datapoints. After data preprocessing, the data was reduced to 3500 data points. 




2. "Identification of factors influencing severity of motorcycle crashes in Dhaka,
Bangladesh using binary logistic regression model"

Problem:<br>
-One of the most common unnatural causes of death across the world is road accidents,
so it is important to identify strong predictors associated with such accidents.
-According to the World Health Organization, most of the road crash deaths that occur worldwide happen in developing countries. 
-Researchers focus on motorcycle crashes in Dhaka, the capital city of Bangladesh. It is stated that the rate of road crashes in Bangladesh is significantly greater than other
developing countries, and Dhaka has the greatest amount of motorists and
reported motorcycle crashes.
-It is noted that most research about this topic is done on data from developed countries
and not developing countries. So the conclusions drawn from existing studies may not
be applicable to the problems the developing countries are facing
-Knowing which predictors are strongly associated with motorcycle crashes in Dhaka helps builders and developers eliminate or reduce these risk factors as they are building new roads.
This study serves as a step in preventing more motorcycle road crashes as developing countries are being built. 

Solution:<br>
-Researchers conduct a binary logistic regression analysis to identify predictors most strongly associated with the occurrence of the outcome, motorcycle crash severity (fatal/ non- fatal)
-They began the study by choosing predictors identified in previous literature about similar topics. Commonly identified predictors of motorcycle crashes are grouped into five broad categories: environment, road characteristics, driver characteristics, motorcycle features, and type of collision.
-The binary logistic regression equation is given as the log odds of the probability of the occurrence of the outcome. An explanation of every variable in the equation is given (slopes, intercept, odds ratio, and relation to the outcome variable).

Data:<br>
-Data was collected from 2006 to 2015 from the Accident Research Institute of Bangladesh University of Engineering and Technology. Only 316 data points were used, and each contained information about motorcycle crashes. <br>
-There are five broad categories encompassing all predictors. The five categories and predictors are:<br>
1. Environmental factors- date/time, lighting, weather<br>
2. Collision type- five different types of collisions<br>
3. Driver characteristics- gender, age, alcohol consumption, and use of a helmet<br>
4. Road characteristics-location, traffic characteristics, road conditions<br>
5. vehicle characteristics- type of other vehicle in crash, weight of other vehicle in crash, motorcycle condition, and more <br>
-The outcome variable, crash injury severity, originally had four levels. Observations from this predictor were then reclassified as either “fatal” or “non-fatal” for a binary outcome.<br>
-To determine which predictors to include in the dataset, researchers conducted a univariate analysis and a chi- square test of each individual predictor to assess significance. All significant predicators were then chosen for the dataset, used for the binary logistic regression. After this, multicollinearity was assessed using the VIF and none of the predictors showed multicollinearity.<br>

Results/ Conclusions:<br>
-After conducting the binary logistic regression, 11 out of the 16 included predictors were found to be significantly associated with the outcome. The significant predictors were day of the week, seasonal condition, time of day, three types of road characteristics, crash type, condition of motorcycle, type of other vehicle in accident, use of helmet, and alcohol consumption<br>
-The regression curve from the analysis was also found to be significant<br>
-Goodness of fit was assessed using a test called the Hosmer and Lemeshow test<br>
-The discussion section details each significant predictor, and interpretations of slopes are given in relation to the outcome variable and the reference groups. <br>
-Some of the findings were consistent with other studies, and some of the findings contradict conclusions in previous studies.<br>
-Most notable conclusions from this study that researchers believe would improve road safety and reduce motorcycle accident severity in developing countries:<br>
1. better lighting conditions for enhanced visibility<br>
2. solution to wet/ slippery roads during rainy season<br>
3. educate drivers about how to drive during unsafe conditions, such as nighttime, heavy rain, and heavy traffic on weekends. Also educate drivers to follow proper safety and speeding regulations. And better education/ training/ evaluation for drivers operating larger vehicles <br>
4. improved pedestrian walkways and road areas<br>
5. strict enforcement of laws regarding helmet use and alcohol while driving<br>
Limitations:<br>
-Missing information in the data: Some important predictors were entirely excluded from the study due to missing information in the dataset. So there may be some extremely relevant predictors that have yet to be studied. There is also an ongoing issue of accidents that go unreported due to lack of fatality, and drivers do not report these incident. 


#### Articles about detecting fraud:

1.	"Using Binary logistic Regression to Detect Health Insurance Fraud"


Problem: <br>
-Insurance fraud in health insurance industry. Specifically, patients treated at private clinics or hospitals. <br>
-Intro of the article explains why this topic is relevant. Between 1965 and 2008, the cost of healthcare increased significantly, and as a result, health insurance fraud has increased. There needs to be effective tools at detecting this fraud.<br>
-If fraud is decreased, it will help the economy as a whole, it will help insurance companies, and it will lower premium payments made by customers. <br>
-Fraud is committed by three types of entities: consumer, provider, and payer fraud.<br>
-Literature review cites common predictors of health insurance fraud: diagnoses, service cost, number of claims from individual, greatest costing claim, probability of anomaly, excessive charges by care facilities, and more.


Data:<br>
-Original dataset contained 26 independent variables<br>
-Data was collected from a time span of January 2022 through November 2022<br>
-about 123,000 data points with no missing values.<br>
-The predictors are of varying types, including numerical, categorical, and binary values<br>
-The dependent variable is fraud, with a value of 1 for fraud present, or 0 for no fraud present.<br>

Solution to Problem:<br>
Why they selected this model:<br>
-Building a binary logistic regression model to detect health insurance fraud<br>
-logistic regression is selected as the analytic technique because they want to assess effects of categorical variables on a categorical dependent variable. They also cite that logistic regression is the most accurate type of regression model with the kind of classification they are performing in this study.<br>
-Fraud detection commonly employs binary prediction models<br>
-The logistic regression model also provides estimates between 0 and 1, which help investigators estimate probability of fraud<br>
-Researchers provide the equation they use to calculate the log odds of the event of interest (occurrence of fraud)<br>
The method:<br>
-They calculate likelihood of an individual committing fraud<br>
-They calculate total cost accrued by an individual. Then they perform the logistic regression using this calculation<br>
-The model works by identifying outliers and classifies them as potential fraudulent activity
-Before testing the model, researchers hypothesize that there will be a positive relationship between overall cost accrued by patient and likelihood of fraud. Costs include doctor visit costs, prescription drug costs, lab costs, costs of medical symptoms, and total cost of expensive prescriptions. <br>
-When running the model, none of the coefficients were zero, which means that there exists a significant relationship between the outcome and the predictor variables. <br>
-Predictors were tested for multicollinearity before the model was run. Pearson correlation coefficients were obtained, and any predictors with a Pearson value of greater than 0.8 were excluded from the model. Only eight predictors remained after removing the predictors that were strongly correlated.<br>
-Different models were constructed using only the most important predictors. When taking away the least important predictor, the log likelihood was calculated to assess the accuracy of the model. The best performing model contained six of the original predictors. <br>

Results:<br>
-Six predictors were found to be significant in predicting health insurance fraud. The predictors are office visit cost, prescription costs, lab costs, symptom cost, and two expensive prescription drug costs. <br>
-There is a thorough interpretation of model slopes. For example, “the likelihood of fraud increases by .005188 for every unit increase in pharmacy cost.” Interpretations for the most significant predictors are given in this way. <br>
-A Chi- Suare test for independence was used to determine whether at least one predictor was significantly related to the outcome. It was concluded that at least one of the six predictors was significant. <br>
-The model was found to be about 99% accurate when predicting no fraud, but only about 76% accurate when predicting fraud. <br>
-An example is included that shows how to calculate the probability that an individual will commit insurance fraud, given values for the six predictors in the equation. <br>
-The study concludes by stating the importance and relevance of continuing to develop new fraud detection models.<br> 

Limitations:<br>
-No limitations are explicitly stated in this paper. However, it can be considered a limitation that only data from middle eastern countries was used in the study. To make the results of the study more generalizable, data from other regions of the world should be included in a more comprehensive study.


<!--## Methods

-   Detail the models or algorithms used.

-   Justify your choices based on the problem and data.

*The common non-parametric regression model is*
$Y_i = m(X_i) + \varepsilon_i$*, where* $Y_i$ *can be defined as the sum
of the regression function value* $m(x)$ *for* $X_i$*. Here* $m(x)$ *is
unknown and* $\varepsilon_i$ *some errors. With the help of this
definition, we can create the estimation for local averaging i.e.*
$m(x)$ *can be estimated with the product of* $Y_i$ *average and* $X_i$
*is near to* $x$*. In other words, this means that we are discovering
the line through the data points with the help of surrounding data
points. The estimation formula is printed below [@R-base]:*

$$
M_n(x) = \sum_{i=1}^{n} W_n (X_i) Y_i  \tag{1}
$$$W_n(x)$ *is the sum of weights that belongs to all real numbers.
Weights are positive numbers and small if* $X_i$ *is far from* $x$*.*

*Another equation:*

$$
y_i = \beta_0 + \beta_1 X_1 +\varepsilon_i
$$

## Analysis and Results

### Data Exploration and Visualization

-   Describe your data sources and collection process.

-   Present initial findings and insights through visualizations.

-   Highlight unexpected patterns or anomalies.

A study was conducted to determine how...

```{r, warning=FALSE, echo=T, message=FALSE}
# loading packages 
library(tidyverse)
library(knitr)
library(ggthemes)
library(ggrepel)
library(dslabs)
```



```{r, warning=FALSE, echo=TRUE}
# Load Data
kable(head(murders))

ggplot1 = murders %>% ggplot(mapping = aes(x=population/10^6, y=total)) 

  ggplot1 + geom_point(aes(col=region), size = 4) +
  geom_text_repel(aes(label=abb)) +
  scale_x_log10() +
  scale_y_log10() +
  geom_smooth(formula = "y~x", method=lm,se = F)+
  xlab("Populations in millions (log10 scale)") + 
  ylab("Total number of murders (log10 scale)") +
  ggtitle("US Gun Murders in 2010") +
  scale_color_discrete(name = "Region")+
      theme_bw()
  

```

### Modeling and Results

-   Explain your data preprocessing and cleaning steps.

-   Present your key findings in a clear and concise manner.

-   Use visuals to support your claims.

-   **Tell a story about what the data reveals.**

```{r}

```

### Conclusion

-   Summarize your key findings.

-   Discuss the implications of your results.

## References

-->
TEST TEST TEST